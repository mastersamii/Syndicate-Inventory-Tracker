<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>House Inventory</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { margin-bottom: 0.5rem; }
    form { margin-bottom: 1rem; display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: flex-end; }
    label { display: flex; flex-direction: column; font-size: 0.9rem; }
    input, select { padding: 0.25rem 0.4rem; }
    button { padding: 0.4rem 0.8rem; cursor: pointer; }
    table { border-collapse: collapse; width: 100%; margin-top: 0.5rem; }
    th, td { border: 1px solid #ccc; padding: 0.4rem 0.5rem; text-align: left; }
    th { background: #f5f5f5; }
  </style>
</head>
<body>
  <h1>House Inventory</h1>
  <p>Add items below. Your list is saved in this browser automatically.</p>

  <form id="item-form">
    <label>
      Item name
      <input type="text" id="itemName" required />
    </label>
    <label>
      Room / Area
      <input type="text" id="itemRoom" placeholder="Kitchen, Bedroom, etc." />
    </label>
    <label>
      Quantity
      <input type="number" id="itemQty" min="1" value="1" />
    </label>
    <label style="flex: 1 1 200px;">
      Notes
      <input type="text" id="itemNotes" placeholder="Brand, color, serial number..." />
    </label>
    <button type="submit">Add / Update</button>
    <button type="button" id="clearAll" style="margin-left: auto;">Clear all</button>
  </form>

  <input
    type="text"
    id="search"
    placeholder="Search by name, room, or notes..."
    style="width: 100%; padding: 0.4rem; margin-bottom: 0.5rem;"
  />

  <table>
    <thead>
      <tr>
        <th>#</th>
        <th>Item</th>
        <th>Room</th>
        <th>Qty</th>
        <th>Notes</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="inventoryBody"></tbody>
  </table>

  <script>
    const STORAGE_KEY = "houseInventory_v1";
    let inventory = [];
    let editingIndex = null;

    function loadInventory() {
      const saved = localStorage.getItem(STORAGE_KEY);
      if (saved) {
        try {
          inventory = JSON.parse(saved);
        } catch (e) {
          console.error("Error loading inventory", e);
          inventory = [];
        }
      }
    }

    function saveInventory() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(inventory));
    }

    function renderInventory(filterText = "") {
      const tbody = document.getElementById("inventoryBody");
      tbody.innerHTML = "";
      const search = filterText.toLowerCase();

      inventory
        .map((item, index) => ({ ...item, index }))
        .filter((row) => {
          if (!search) return true;
          return (
            row.name.toLowerCase().includes(search) ||
            (row.room || "").toLowerCase().includes(search) ||
            (row.notes || "").toLowerCase().includes(search)
          );
        })
        .forEach((row, displayIndex) => {
          const tr = document.createElement("tr");

          tr.innerHTML = `
            <td>${displayIndex + 1}</td>
            <td>${row.name}</td>
            <td>${row.room || ""}</td>
            <td>${row.qty}</td>
            <td>${row.notes || ""}</td>
            <td>
              <button data-action="edit" data-index="${row.index}">Edit</button>
              <button data-action="delete" data-index="${row.index}">Delete</button>
            </td>
          `;

          tbody.appendChild(tr);
        });
    }

    function resetForm() {
      document.getElementById("itemName").value = "";
      document.getElementById("itemRoom").value = "";
      document.getElementById("itemQty").value = 1;
      document.getElementById("itemNotes").value = "";
      editingIndex = null;
    }

    document.getElementById("item-form").addEventListener("submit", (e) => {
      e.preventDefault();
      const name = document.getElementById("itemName").value.trim();
      const room = document.getElementById("itemRoom").value.trim();
      const qty = parseInt(document.getElementById("itemQty").value) || 1;
      const notes = document.getElementById("itemNotes").value.trim();

      if (!name) return;

      const item = { name, room, qty, notes };

      if (editingIndex !== null) {
        inventory[editingIndex] = item;
      } else {
        inventory.push(item);
      }

      saveInventory();
      renderInventory(document.getElementById("search").value);
      resetForm();
    });

    document.getElementById("inventoryBody").addEventListener("click", (e) => {
      const button = e.target;
      if (button.tagName !== "BUTTON") return;

      const action = button.getAttribute("data-action");
      const index = parseInt(button.getAttribute("data-index"), 10);

      if (action === "delete") {
        if (confirm("Delete this item?")) {
          inventory.splice(index, 1);
          saveInventory();
          renderInventory(document.getElementById("search").value);
        }
      } else if (action === "edit") {
        const item = inventory[index];
        document.getElementById("itemName").value = item.name;
        document.getElementById("itemRoom").value = item.room;
        document.getElementById("itemQty").value = item.qty;
        document.getElementById("itemNotes").value = item.notes;
        editingIndex = index;
      }
    });

    document.getElementById("clearAll").addEventListener("click", () => {
      if (confirm("Clear ALL items? This cannot be undone.")) {
        inventory = [];
        saveInventory();
        renderInventory();
        resetForm();
      }
    });

    document.getElementById("search").addEventListener("input", (e) => {
      renderInventory(e.target.value);
    });

    loadInventory();
    renderInventory();
  </script>
</body>
</html>
